Author: Pino Toscano <pino@debian.org>
Description: Enable RPATH also on kFreeBSD and Hurd
 qtcreator's plugins use RPATH to locate the qtcreator libraries, so enable it
 also on kFreeBSD and Hurd.
Reviewed-by: Lisandro Damián Nicanor Pérez Meyer <lisandro@debian.org>
Last-Update: 2019-12-12
Forwarded: no

---
 src/qtcreatorplugin.pri                         |    2 +-
 src/rpath.pri                                   |    2 +-
 src/tools/qtcreatorwidgets/qtcreatorwidgets.pro |    4 ++--
 3 files changed, 4 insertions(+), 4 deletions(-)

--- a/src/rpath.pri
+++ b/src/rpath.pri
@@ -8,7 +8,7 @@ REL_PATH_TO_PLUGINS = $$relative_path($$
 
 macos {
     QMAKE_LFLAGS += -Wl,-rpath,@loader_path/$$REL_PATH_TO_LIBS,-rpath,@loader_path/$$REL_PATH_TO_PLUGINS
-} else:linux-* {
+} else:linux-*|glibc-*|hurd-* {
     QMAKE_RPATHDIR += \$\$ORIGIN
     QMAKE_RPATHDIR += \$\$ORIGIN/$$REL_PATH_TO_LIBS
     QMAKE_RPATHDIR += \$\$ORIGIN/$$REL_PATH_TO_PLUGINS
--- a/src/qtcreatorplugin.pri
+++ b/src/qtcreatorplugin.pri
@@ -96,7 +96,7 @@ contains(QT_CONFIG, reduce_exports):CONF
 
 TEMPLATE = lib
 CONFIG += plugin plugin_with_soname
-linux*:QMAKE_LFLAGS += $$QMAKE_LFLAGS_NOUNDEF
+linux*|glibc-*|hurd-*:QMAKE_LFLAGS += $$QMAKE_LFLAGS_NOUNDEF
 
 target.path = $$INSTALL_PLUGIN_PATH
 INSTALLS += target
--- a/src/tools/qtcreatorwidgets/qtcreatorwidgets.pro
+++ b/src/tools/qtcreatorwidgets/qtcreatorwidgets.pro
@@ -13,7 +13,7 @@ isEmpty(IDE_LIBRARY_BASENAME) {
     IDE_LIBRARY_BASENAME = lib
 }
 
-linux-*||win32 {
+linux-*||win32||glibc-*||hurd-* {
   # form abs path to qtcreator lib dir
   QTC_LIBS=$$dirname(OUT_PWD)
   QTC_LIBS=$$dirname(QTC_LIBS)
@@ -21,7 +21,7 @@ linux-*||win32 {
   QTC_LIBS=$$QTC_LIBS/$$IDE_LIBRARY_BASENAME/qtcreator
 }
 
-linux-*{  
+linux-*|glibc-*|hurd-*{
   QMAKE_RPATHDIR *= $$QTC_LIBS
 }
 
